<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Transportation Dispatch Dashboard - 75" Touch Optimized</title>
        <!-- NOTE: Using Tailwind CDN for development/demo purposes only. 
             For production deployment, install Tailwind CSS locally using:
             npm install -D tailwindcss && npx tailwindcss init -->
        <script src="https://cdn.tailwindcss.com?v=3.4.0"></script>
        <style>
            /* Sidebar panel compactness */
            .responsive-sidebar > div, .responsive-sidebar .bg-white, .responsive-sidebar .bg-gradient-to-r, .responsive-sidebar .rounded-lg, .responsive-sidebar .border {
                padding: 0.5rem 0.7rem !important;
                margin-bottom: 0.6rem !important;
                border-radius: 7px !important;
            }
            .responsive-sidebar h2, .responsive-sidebar h1, .responsive-sidebar h4 {
                font-size: 1.02rem !important;
                margin-bottom: 0.3rem !important;
                font-weight: 700 !important;
            }
            .responsive-sidebar .text-xs, .responsive-sidebar .text-sm {
                font-size: 0.92rem !important;
            }
            .responsive-sidebar .status-badge, .responsive-sidebar .bg-red-100, .responsive-sidebar .bg-green-100 {
                padding: 2px 8px !important;
                font-size: 0.92rem !important;
                border-radius: 5px !important;
            }
            .responsive-sidebar .border {
                border-width: 1.2px !important;
            }
            
            /* Asset list auto-fitting text */
            #asset-list, #down-list, #spares-list {
                overflow-x: hidden !important;
            }
            .asset-item, .down-asset-item, .spare-asset-item {
                display: flex;
                flex-direction: row;
                align-items: center;
                min-width: 320px;
                max-width: 100%;
                padding: 12px 16px;
                gap: 16px;
            }
            .asset-item .font-bold, .down-asset-item .font-bold, .spare-asset-item .font-bold {
                white-space: normal !important;
                word-break: break-word !important;
                font-size: 1rem;
            }
            .asset-item > div:first-child, .down-asset-item > div:first-child, .spare-asset-item > div:first-child {
                flex: 1 1 auto;
            }
            .asset-item .mark-down-btn, .asset-item .mark-repair-btn {
                display: inline-block;
                min-width: 90px;
                white-space: normal !important;
                word-break: break-word !important;
                font-size: 0.95rem;
                margin-left: 8px;
            }
            .down-asset-item .mark-repair-btn {
                display: inline-block;
                min-width: 90px;
                white-space: normal !important;
                word-break: break-word !important;
                font-size: 0.95rem;
                margin-left: 8px;
            }
            #asset-list .flex {
                font-size: clamp(0.7rem, 1.5vw, 0.85rem);
            }
            #asset-list .font-medium {
                font-size: clamp(0.75rem, 1.6vw, 0.9rem);
                max-width: 120px;
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
            }
            #asset-list .text-xs {
                font-size: clamp(0.6rem, 1.2vw, 0.75rem);
            }
            /* Top bar button refinement */
            header button, .topbar-btn {
                font-size: 0.97rem !important;
                padding: 3px 12px !important;
                min-width: 0 !important;
                min-height: 0 !important;
                height: 32px !important;
                margin: 0 2px !important;
                border-radius: 5px !important;
                box-shadow: none !important;
                vertical-align: middle !important;
            }
            header .flex.items-center.space-x-2 {
                gap: 0.3rem !important;
            }
            header .flex.bg-gray-200.rounded-lg.p-1 {
                margin-left: 0.7rem !important;
                margin-right: 0 !important;
                display: inline-flex !important;
                vertical-align: middle !important;
            }
            #am-toggle, #pm-toggle {
                height: 32px !important;
                min-width: 44px !important;
                font-size: 0.97rem !important;
                font-weight: 700 !important;
                border-radius: 5px !important;
                margin: 0 1px !important;
                padding: 3px 0 !important;
                box-shadow: none !important;
            }
            /* Main background refinement */
            body, #app-container {
                background: #f6f7f9 !important;
            }
            /* Card label alignment */
            .route-card label, .route-card .label, .route-card .field-label {
                text-align: left !important;
                display: block !important;
                margin-bottom: 2px !important;
            }
            /* Card input/textarea refinement */
            .route-card input[type="text"], .route-card textarea {
                border: 1.5px solid #d1d5db !important;
                border-radius: 6px !important;
                font-size: 0.97rem !important;
                padding: 6px 10px !important;
                margin-bottom: 6px !important;
                background: #fff !important;
                color: #222 !important;
            }
            .route-card textarea {
                min-height: 48px !important;
                resize: vertical !important;
            }
            /* Card border color refinement */
            .route-card {
                border-color: #e5e7eb !important;
            }
            /* AM/PM Toggle refinement */
            #am-toggle, #pm-toggle {
                min-width: 44px !important;
                min-height: 28px !important;
                font-size: 1rem !important;
                font-weight: 700 !important;
                border-radius: 6px !important;
                margin: 0 2px !important;
                .responsive-sidebar {
                    width: 25vw !important;           /* 25% of viewport width */
                    min-width: 320px !important;      /* Minimum 320px */
                    max-width: 450px !important;      /* Maximum 450px */
                }                padding: 4px 0 !important;
                box-shadow: none !important;
            }
            #am-toggle.active, #am-toggle.bg-blue-500, #am-toggle.selected {
                background: #2563eb !important;
                color: #fff !important;
            }
            #pm-toggle.active, #pm-toggle.bg-blue-500, #pm-toggle.selected {
                background: #e5e7eb !important;
                color: #222 !important;
            }
            /* Sidebar scrollbar refinement */
            .responsive-sidebar::-webkit-scrollbar {
                width: 7px;
                background: #f3f4f6;
            }
            .responsive-sidebar::-webkit-scrollbar-thumb {
                background: #d1d5db;
                border-radius: 6px;
            }
            .responsive-sidebar::-webkit-scrollbar-track {
                background: #f3f4f6;
            }
            /* Firefox scrollbar styling for supported versions */
            @supports (scrollbar-width: thin) {
                .responsive-sidebar {
                    scrollbar-width: thin;
                    scrollbar-color: #d1d5db #f3f4f6;
                }
            }
            
            /* Hide scrollbars for specific sections while maintaining scroll functionality */
            #staff-available-list::-webkit-scrollbar,
            #staff-out-list::-webkit-scrollbar,
            #down-list::-webkit-scrollbar,
            #spares-list::-webkit-scrollbar {
                width: 0px;
                background: transparent;
            }
            
            #staff-available-list,
            #staff-out-list,
            #down-list,
            #spares-list {
                scrollbar-width: none; /* Firefox */
                -ms-overflow-style: none; /* Internet Explorer 10+ */
            }
            
            /* Hide any scrollbars on Personnel Status section */
            .bg-gradient-to-r.from-blue-50.to-indigo-50::-webkit-scrollbar,
            .bg-gradient-to-r.from-blue-50.to-indigo-50 *::-webkit-scrollbar,
            #staff-summary::-webkit-scrollbar,
            #staff-summary *::-webkit-scrollbar {
                width: 0px !important;
                background: transparent !important;
            }
            
            .bg-gradient-to-r.from-blue-50.to-indigo-50,
            .bg-gradient-to-r.from-blue-50.to-indigo-50 *,
            #staff-summary,
            #staff-summary * {
                scrollbar-width: none !important; /* Firefox */
                -ms-overflow-style: none !important; /* Internet Explorer 10+ */
                overflow: hidden !important;
            }
            /* Responsive Design System */
            :root {
                /* Base font sizes for different screen types */
                --text-xs: 0.75rem;
                --text-sm: 0.85rem;
                --text-base: 1rem;
                --text-lg: 1.1rem;
                --text-xl: 1.25rem;
                --text-2xl: 1.5rem;
                /* Spacing scale that adapts to screen size */
                --spacing-1: 0.2rem;
                --spacing-2: 0.4rem;
                --spacing-3: 0.7rem;
                --spacing-4: 1rem;
                --spacing-6: 1.2rem;
                --spacing-8: 1.8rem;
                /* Touch targets that scale appropriately */
                --touch-target: 36px;
                --touch-padding: 6px;
                /* Panel and container dimensions */
                --sidebar-width: 650px;
                --card-min-width: 260px;
                --modal-width: 400px;
                /* Grid system for different screen sizes */
                --grid-cols-desktop: 4;
                --grid-cols-large: 5;
                --grid-cols-xl: 6;
                --grid-cols-xxl: 7;
            }
            @media (max-width: 1024px) {
                :root {
                    --grid-cols-desktop: 2;
                    --grid-cols-large: 3;
                    --grid-cols-xl: 4;
                    --sidebar-width: clamp(650px, 60vw, 900px);
                }
            }
            @media (max-width: 768px) {
                :root {
                    --grid-cols-desktop: 1;
                    --grid-cols-large: 2;
                    --grid-cols-xl: 3;
                    --sidebar-width: 100%;
                }
            }
            @media (min-width: 1920px) {
                :root {
                    --touch-target: clamp(48px, 2.5vw, 72px);
                    --touch-padding: clamp(12px, 0.8vw, 20px);
                }
            }
            .transition-shadow { transition: box-shadow 0.15s ease-in-out; }
            /* 75-inch Touch Display Optimizations */
            button, .assign-btn, input[type="radio"], input[type="checkbox"], select {
                min-height: 28px !important;
                min-width: 28px !important;
                font-size: 0.95rem !important;
                font-weight: 600 !important;
            }
            button {
                padding: 4px 14px !important;
                border-radius: 6px !important;
                margin: 2px !important;
                box-shadow: none !important;
            }
            .reset-card-btn, .btn-danger, .btn-out, .btn-down {
                background: #ef4444 !important;
                color: #fff !important;
                border-radius: 6px !important;
                font-size: 0.95rem !important;
                font-weight: 600 !important;
                padding: 4px 14px !important;
                border: none !important;
            }
            .reset-card-btn:hover, .btn-danger:hover, .btn-out:hover, .btn-down:hover {
                background: #dc2626 !important;
            }
            .route-card h3 {
                font-size: 1.15rem !important;
                font-weight: 700 !important;
                margin-bottom: 0.7rem !important;
                letter-spacing: 0.01em !important;
            }
            .route-card label, .route-card .label, .route-card .field-label {
                font-weight: 700 !important;
                font-size: 0.95rem !important;
                letter-spacing: 0.01em !important;
            }
            .responsive-sidebar {
                width: 25vw !important;
                min-width: 320px !important;
                max-width: 450px !important;
                background: #fff !important;
                border-left: 1.5px solid #e5e7eb !important;
                box-shadow: 2px 0 8px 0 rgba(0,0,0,0.04) !important;
                padding: 0.5rem 0.5rem 0.5rem 0.7rem !important;
                z-index: 10;
                overflow-x: hidden !important;
                overflow-y: auto !important;
            }
            .responsive-sidebar .bg-gradient-to-r {
                background: none !important;
            }
            .responsive-grid {
                grid-template-columns: repeat(var(--grid-cols-desktop), minmax(var(--card-min-width), 1fr));
                gap: 1.1rem !important;
            }
            @media (min-width: 1280px) {
                .responsive-grid {
                    grid-template-columns: repeat(var(--grid-cols-large), minmax(var(--card-min-width), 1fr));
                }
            }
            @media (min-width: 1536px) {
                .responsive-grid {
                    grid-template-columns: repeat(var(--grid-cols-xl), minmax(var(--card-min-width), 1fr));
                }
            }
            @media (min-width: 1920px) {
                .responsive-grid {
                    grid-template-columns: repeat(var(--grid-cols-xxl), minmax(var(--card-min-width), 1fr));
                }
            }
            .touch-primary button:hover {
                background-color: inherit !important;
            }
            .touch-primary .hover\:scale-105:hover {
                transform: none !important;
            }
            body:not(.touch-primary) button:hover {
                transform: translateY(-1px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
                transition: all 0.2s ease;
            }
            .screen-mobile .responsive-sidebar {
                position: fixed;
                top: 0;
                right: -100%;
                height: 100vh;
                z-index: 1000;
                transition: right 0.3s ease;
            }
            .screen-mobile .responsive-sidebar.open {
                right: 0;
            }
            .large-screen .route-card {
                min-height: clamp(200px, 15vh, 300px);
            }
            .route-card {
                padding: 16px 12px !important;
                margin-bottom: 12px !important;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.10) !important;
                border-radius: 10px !important;
                border-width: 2px !important;
            }
            .space-x-2 > * + * {
                margin-left: 20px !important;
            }
            .space-y-2 > * + * {
                margin-top: 20px !important;
            }
            .space-y-3 > * + * {
                margin-top: 24px !important;
            }
            .gap-2 {
                gap: 20px !important;
            }
            .gap-3 {
                gap: 24px !important;
            }
            input[type="radio"] {
                width: 20px !important;
                height: 20px !important;
                margin-right: 12px !important;
            }
            .text-xs {
                font-size: 16px !important;
                font-weight: 500 !important;
            }
            .text-sm {
                font-size: 18px !important;
                font-weight: 500 !important;
            }
            .text-lg {
                font-size: 22px !important;
                font-weight: 600 !important;
            }
            .text-xl {
                font-size: 26px !important;
                font-weight: 700 !important;
            }
            .bg-gray-50 {
                background-color: #f8fafc !important;
                border: 2px solid #e2e8f0 !important;
            }
            .modal-content {
                padding: 40px !important;
                border-radius: 20px !important;
            }
            textarea {
                min-height: 100px !important;
                font-size: 18px !important;
                padding: 20px !important;
                border-radius: 8px !important;
                border-width: 2px !important;
            }
            .sidebar-item {
                padding: 20px !important;
                margin-bottom: 16px !important;
                font-size: 18px !important;
                border-radius: 12px !important;
            }
            #am-toggle, #pm-toggle {
                padding: 20px 32px !important;
                font-size: 20px !important;
                font-weight: bold !important;
                border-radius: 12px !important;
                margin: 0 8px !important;
            }
            input[type="text"], input[type="color"], select {
                padding: 16px !important;
                font-size: 18px !important;
                border-radius: 8px !important;
                border-width: 2px !important;
                margin: 4px 0 !important;
            }
            .status-badge, .route-type-badge, .badge {
                padding: 2px 10px !important;
                font-size: 0.95rem !important;
                font-weight: 700 !important;
                border-radius: 5px !important;
                line-height: 1.2 !important;
                margin-left: 6px !important;
            }
            .route-type-badge.gen-ed, .badge.gen-ed {
                background: #2563eb !important;
                color: #fff !important;
            }
            .route-type-badge.se, .badge.se {
                background: #dc2626 !important;
                color: #fff !important;
            }
            .route-type-badge.misc, .badge.misc {
                background: #10b981 !important;
                color: #fff !important;
            }
            .route-type-badge.field-trip, .badge.field-trip {
                background: #a21caf !important;
                color: #fff !important;
            }
            .grid {
                gap: 32px !important;
            }
            .close-btn {
                font-size: 32px !important;
                padding: 12px !important;
                border-radius: 8px !important;
                min-width: 48px !important;
                min-height: 48px !important;
            }
            .assign-btn {
                padding: 16px !important;
                margin: 8px 0 !important;
                border-width: 2px !important;
                border-radius: 8px !important;
                font-weight: 500 !important;
            }
            .settings-section {
                padding: 24px !important;
                margin: 16px 0 !important;
                border-radius: 12px !important;
            }
            .keyboard-focusable {
                transition: all 0.2s ease;
            }
            .keyboard-focusable:focus {
                outline: 2px solid #3b82f6;
                outline-offset: 2px;
                box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
                z-index: 1;
                position: relative;
            }
            .keyboard-nav-active {
                outline: 2px solid #3b82f6;
                outline-offset: 1px;
                background-color: rgba(59, 130, 246, 0.05);
            }
            .route-card:focus,
            .staff-item:focus,
            .asset-item:focus {
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
            }
            .search-highlight {
                background-color: #fef3c7 !important;
                color: #92400e !important;
                padding: 2px 4px !important;
                border-radius: 3px !important;
                font-weight: 600 !important;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2) !important;
                animation: highlight-pulse 0.5s ease-in-out;
            }
            @keyframes highlight-pulse {
                0% { background-color: #fbbf24; }
                50% { background-color: #fef3c7; }
                100% { background-color: #fef3c7; }
            }
            #search-results-count {
                transition: all 0.3s ease;
            }
            #global-search:focus {
                box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1), 0 1px 3px rgba(0, 0, 0, 0.1);
            }
            .filter-btn {
                transition: all 0.2s ease;
            }
            .filter-btn:hover {
                transform: translateY(-1px);
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            #advanced-search-modal .bg-white {
                animation: modalSlideIn 0.3s ease-out;
            }
            #search-overlay {
                -webkit-backdrop-filter: blur(4px);
                backdrop-filter: blur(4px);
            }
            #search-overlay .bg-white {
                animation: searchOverlaySlideIn 0.3s ease-out;
                box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            }
            @keyframes searchOverlaySlideIn {
                from {
                    opacity: 0;
                    transform: translateY(-20px) scale(0.95);
                }
                to {
                    opacity: 1;
                    transform: translateY(0) scale(1);
                }
            }
            .filter-quick-btn {
                padding: 4px 8px;
                font-size: 11px;
                border: 1px solid #e5e7eb;
                border-radius: 4px;
                background-color: #f9fafb;
                color: #6b7280;
                transition: all 0.2s ease;
                cursor: pointer;
            }
            .filter-quick-btn:hover {
                background-color: #f3f4f6;
                border-color: #d1d5db;
            }
            .filter-quick-btn.active {
                background-color: #3b82f6;
                color: white;
                border-color: #3b82f6;
            }
            #overlay-search-input:focus {
                box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1), 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            }
            @keyframes modalSlideIn {
                from {
                    opacity: 0;
                    transform: translateY(-50px) scale(0.95);
                }
                to {
                    opacity: 1;
                    transform: translateY(0) scale(1);
                }
            }
            kbd {
                font-family: ui-monospace, SFMono-Regular, "SF Mono", Monaco, Cascadia, "Segoe UI Mono", Roboto Mono, Menlo, "Liberation Mono", Consolas, monospace;
                font-size: 0.75rem;
                font-weight: 600;
                line-height: 1;
                color: #374151;
                background-color: #f3f4f6;
                border: 1px solid #d1d5db;
                border-radius: 0.25rem;
                box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
                padding: 0.25rem 0.5rem;
                display: inline-block;
            }
            .shortcut-combo {
                display: flex;
                align-items: center;
                gap: 0.25rem;
            }
            .shortcut-combo kbd {
                margin: 0;
            }
            .shortcut-divider {
                color: #6b7280;
                font-weight: 400;
            }
            .touch-gestures-enabled {
                touch-action: manipulation;
            }
            .touch-active {
                background-color: rgba(59, 130, 246, 0.05) !important;
                border-color: #3b82f6 !important;
            }
            .long-press-active {
                animation: pulse-blue 1s infinite;
            }
            @keyframes pulse-blue {
                0%, 100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4); }
                50% { box-shadow: 0 0 0 8px rgba(59, 130, 246, 0); }
            }
            .swipe-indicator {
                animation: swipe-fade 0.5s ease;
            }
            @keyframes swipe-fade {
                0% {
                    opacity: 0;
                    transform: translate(-50%, -50%) scale(0.8);
                }
                50% {
                    opacity: 1;
                    transform: translate(-50%, -50%) scale(1.1);
                }
                100% {
                    opacity: 1;
                    transform: translate(-50%, -50%) scale(1);
                }
            }
            .touch-context-menu {
                -webkit-backdrop-filter: blur(8px);
                backdrop-filter: blur(8px);
                background-color: rgba(255, 255, 255, 0.95);
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
                border: 1px solid rgba(59, 130, 246, 0.2);
            }
            .touch-context-menu button:hover {
                background-color: rgba(59, 130, 246, 0.1);
                color: #3b82f6;
            }
            .touch-gestures-enabled .route-card,
            .touch-gestures-enabled .staff-item,
            .touch-gestures-enabled .asset-item {
                touch-action: none; /* Allow custom gestures */
                -webkit-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
            }
            .pinch-zoom-active {
                transition: transform 0.1s ease;
                z-index: 10;
                position: relative;
            }
            .swipe-feedback {
                border: 2px dashed #3b82f6;
                background-color: rgba(59, 130, 246, 0.05);
                transition: all 0.3s ease;
            }
            .minimal-view {
                display: none;
            }
            .collapsible-content {
                transition: all 0.3s ease;
                overflow: hidden;
            }
            .route-card-collapsed {
                height: auto;
                min-height: 120px; /* Consistent minimum height for collapsed cards */
            }
            .route-card-expanded {
                height: auto;
            }
            .collapse-btn {
                cursor: pointer;
                -webkit-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
                transition: all 0.2s ease;
            }
            .collapse-btn:hover {
                transform: scale(1.1);
            }
            .trailer-btn {
                min-height: 36px !important;
                min-width: 64px !important;
                font-size: 12px !important;
                padding: 6px 12px !important;
                transition: all 0.2s ease !important;
            }
            .trailer-btn:hover {
                background-color: rgba(251, 146, 60, 0.1) !important;
                border-color: rgb(251, 146, 60) !important;
            }
            /* Settings slideout optimization */
            #settings-slideout {
                will-change: transform;
            }
        </style>
</head>
<body class="bg-gray-100 font-sans">
        <div id="app-container" class="flex flex-col h-screen">
            <!-- Top Bar -->
            <header class="bg-white shadow-md p-2 flex justify-between items-center z-20">
                <div class="flex items-center gap-2">
                    <!-- Hamburger Menu Button -->
                    <button id="hamburger-menu-btn" class="p-2 rounded hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500" aria-label="Open settings menu">
                        <svg class="w-7 h-7 text-gray-700" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                    <h1 class="text-xl font-bold text-gray-800">Interactive Dispatch Dashboard</h1>
                </div>
                <div class="flex items-center space-x-2">
                     <button id="search-toggle-btn" class="px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors text-sm" title="Search Dashboard (Ctrl+F)">
                         ⏳
                     </button>
                     <button id="reset-board-btn" class="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors text-sm">
                         🔄 Reset Board
                     </button>
                     <button id="timestamp-report-btn" class="px-3 py-1 bg-green-500 text-white rounded hover:bg-green-600 transition-colors text-sm">
                         📋 Status Report
                     </button>
                     <!-- AM/PM Toggle -->
                     <div class="flex bg-gray-200 rounded-lg p-1">
                         <button id="am-toggle" class="px-3 py-1 rounded bg-blue-500 text-white text-sm font-semibold">AM</button>
                         <button id="pm-toggle" class="px-3 py-1 rounded text-gray-700 text-sm font-semibold">PM</button>
                     </div>
                </div>
            </header>
        <!-- Left Slide-Out Settings Menu -->
        <aside id="settings-slideout" class="fixed top-0 left-0 h-full w-[380px] max-w-full bg-white shadow-2xl border-r border-gray-200 z-50 transform -translate-x-full transition-transform duration-300 ease-in-out flex flex-col">
            <div class="flex items-center justify-between p-4 border-b">
                <h2 class="text-lg font-bold text-blue-700 flex items-center gap-2">⚙️ Settings</h2>
                <button id="settings-slideout-close" class="text-gray-500 hover:text-gray-700 text-2xl font-bold px-2 py-1 rounded focus:outline-none" aria-label="Close settings menu">×</button>
            </div>
            <div id="settings-slideout-content" class="flex-1 overflow-y-auto p-4">
                <!-- Settings Main Menu -->
                <div id="settings-main-menu">
                    <ul class="space-y-2">
                        <li>
                            <button id="open-comprehensive-settings" class="w-full text-left px-4 py-2 bg-gray-100 hover:bg-purple-100 rounded text-purple-700 font-semibold flex items-center gap-2">
                                ⚙️ Dashboard Settings
                            </button>
                        </li>
                        <li>
                            <button id="open-route-management" class="w-full text-left px-4 py-2 bg-gray-100 hover:bg-blue-100 rounded text-blue-700 font-semibold flex items-center gap-2">
                                🛣️ Route Management
                            </button>
                        </li>
                        <li>
                            <button id="open-asset-management" class="w-full text-left px-4 py-2 bg-gray-100 hover:bg-green-100 rounded text-green-700 font-semibold flex items-center gap-2">
                                🚛 Asset Management
                            </button>
                        </li>
                        <li>
                            <button id="open-staff-management" class="w-full text-left px-4 py-2 bg-gray-100 hover:bg-purple-100 rounded text-purple-700 font-semibold flex items-center gap-2">
                                👥 Staff Management
                            </button>
                        </li>
                        <li>
                            <button id="open-search-dialog" class="w-full text-left px-4 py-2 bg-gray-100 hover:bg-blue-100 rounded text-blue-700 font-semibold flex items-center gap-2">
                                🔍 Advanced Search
                            </button>
                        </li>
                        <li>
                            <button id="export-all-data" class="w-full text-left px-4 py-2 bg-gray-100 hover:bg-yellow-100 rounded text-yellow-700 font-semibold flex items-center gap-2">
                                📤 Export Data
                            </button>
                        </li>
                        <li>
                            <button id="import-data" class="w-full text-left px-4 py-2 bg-gray-100 hover:bg-green-100 rounded text-green-700 font-semibold flex items-center gap-2">
                                📥 Import Data
                            </button>
                        </li>
                    </ul>
                </div>
            </div>
        </aside>

            <!-- Main Content Area -->

            <div class="flex flex-1 overflow-hidden" id="main-dashboard-layout">
                <!-- Resource Monitor Panel -->
                <aside class="responsive-sidebar bg-white shadow-lg p-4 overflow-y-auto" id="resource-sidebar">
                    <!-- Resource Monitor Header -->
                    <div class="mb-6 text-center border-b-2 border-blue-200 pb-4">
                        <h1 class="text-2xl font-bold text-gray-800 flex items-center justify-center gap-2">
                            <span>📊</span> Resource Monitor
                        </h1>
                        <p class="text-sm text-gray-600 mt-1">Real-time fleet and personnel status</p>
                    </div>

                    <!-- Personnel Section -->
                    <div class="mb-8 bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg p-4 border border-gray-200">
                        <div class="flex justify-between items-center mb-4 border-b border-gray-200 pb-2">
                            <h2 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                                <span>👥</span> Personnel Status
                            </h2>
                            <button id="staff-details-btn" class="px-3 py-1 bg-blue-500 text-white text-sm rounded hover:bg-blue-600 transition-colors">
                                Staff Details
                            </button>
                        </div>
                        <div class="space-y-4">
                            <!-- Available Staff (Top) -->
                            <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-3 border border-green-200">
                                <h4 class="text-md font-bold mb-3 text-green-800 flex items-center gap-2">
                                    <span>✅</span> Available Staff
                                    <span id="staff-available-summary" class="ml-auto text-xs bg-green-100 px-2 py-1 rounded-full"></span>
                                </h4>
                                <div class="bg-white rounded-lg p-2 border border-green-200">
                                    <div id="staff-available-list" class="text-sm space-y-2 max-h-40 overflow-y-auto">
                                        Loading...
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Out of Service (Bottom) -->
                            <div class="bg-gradient-to-r from-red-50 to-pink-50 rounded-lg p-3 border border-red-200">
                                <h4 class="text-md font-bold mb-3 text-red-800 flex items-center gap-2">
                                    <span>🚫</span> Out of Service
                                    <span id="staff-out-summary" class="ml-auto text-xs bg-red-100 px-2 py-1 rounded-full"></span>
                                </h4>
                                <div class="bg-white rounded-lg p-2 border border-red-200">
                                    <div id="staff-out-list" class="text-sm space-y-2 max-h-40 overflow-y-auto">
                                        Loading...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Fleet Service Section -->
                    <div class="mb-6 bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg p-4 border border-gray-200">
                        <div class="flex justify-between items-center mb-4 border-b border-gray-200 pb-2">
                            <h2 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                                <span>🔧</span> Fleet Service
                            </h2>
                        </div>
                        <div id="fleet-service" class="space-y-3">
                            <!-- Fleet service content will be dynamically rendered here -->
                        </div>
                    </div>

                    <!-- Fleet Status Section -->
                    <div class="mb-6 bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg p-4 border border-gray-200">
                        <div class="flex justify-between items-center mb-4 border-b border-gray-200 pb-2">
                            <h2 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                                <span>🚛</span> Fleet Status
                            </h2>
                            <button id="fleet-details-btn" class="px-3 py-1 bg-blue-500 text-white text-sm rounded hover:bg-blue-600 transition-colors">
                                Fleet Details
                            </button>
                        </div>
                        
                        <div class="space-y-4">
                            <!-- Available Spares (Top) -->
                            <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-3 border border-green-200">
                                <h3 class="text-md font-bold mb-3 text-green-800 flex items-center gap-2">
                                    <span>🔧</span> Available Spares
                                    <span id="spares-summary" class="ml-auto text-xs bg-green-100 px-2 py-1 rounded-full"></span>
                                </h3>
                                <div class="bg-white rounded-lg p-2 border border-green-200">
                                    <div id="spares-list" class="text-sm space-y-2 max-h-40 overflow-y-auto">
                                        Loading...
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Down List (Bottom) -->
                            <div class="bg-gradient-to-r from-red-50 to-pink-50 rounded-lg p-3 border border-red-200">
                                <h3 class="text-md font-bold mb-3 text-red-800 flex items-center gap-2">
                                    <span>⚠️</span> Down List
                                    <span id="down-summary" class="ml-auto text-xs bg-red-100 px-2 py-1 rounded-full"></span>
                                </h3>
                                <div class="bg-white rounded-lg p-2 border border-red-200">
                                    <div id="down-list" class="text-sm space-y-2 max-h-40 overflow-y-auto">
                                        Loading...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>
                <!-- Main Content -->
                <main id="route-cards-container" class="flex-1 overflow-y-auto p-4">
                    <!-- Route Cards Grid -->
                    <section id="route-cards-grid" class="space-y-8">
                        <!-- Route cards will be dynamically rendered here by JS -->
                    </section>
                    <div id="loading-message" class="text-center py-8">
                        <div class="text-gray-500">Loading route cards...</div>
                    </div>
                </main>
            </div>
        </div>

        <!-- Assignment Modal -->

                <!-- Assignment Modal -->
                <div id="assignment-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                    <div class="bg-white rounded-lg p-6 w-96 max-w-full">
                        <h3 id="modal-title" class="text-lg font-bold mb-4">Assign Staff</h3>
                        <input type="text" id="modal-search" placeholder="Search..." class="w-full p-2 border rounded mb-3">
                        <div id="modal-list" class="max-h-64 overflow-y-auto space-y-1 mb-4"></div>
                        <div class="flex justify-end space-x-2">
                            <button id="modal-cancel" class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400">Cancel</button>
                            <button id="modal-confirm" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Assign</button>
                        </div>
                    </div>
                </div>

                <!-- Settings Modal -->
                <div id="settings-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-lg p-6 w-full max-w-6xl h-full max-h-[90vh] overflow-hidden flex flex-col">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">Dashboard Settings</h3>
                            <button id="settings-close" class="text-gray-500 hover:text-gray-700 text-xl">×</button>
                        </div>
                        <!-- Tab Navigation -->
                        <div class="flex space-x-1 mb-4 border-b">
                            <button id="tab-data" class="tab-button px-4 py-2 font-medium text-sm border-b-2 border-blue-500 text-blue-600">Data Management</button>
                            <button id="tab-colors" class="tab-button px-4 py-2 font-medium text-sm border-b-2 border-transparent text-gray-500 hover:text-gray-700">Appearance</button>
                            <button id="tab-controls" class="tab-button px-4 py-2 font-medium text-sm border-b-2 border-transparent text-gray-500 hover:text-gray-700">Controls</button>
                            <button id="tab-import" class="tab-button px-4 py-2 font-medium text-sm border-b-2 border-transparent text-gray-500 hover:text-gray-700">Import/Export</button>
                        </div>
                        <!-- Tab Content (to be filled by JS) -->
                        <div class="flex-1 overflow-hidden">
                            <!-- ...tab content will be rendered here by JS... -->
                        </div>
                        <div class="mt-4 flex justify-end space-x-2 border-t pt-4">
                            <button id="settings-cancel" class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400">Cancel</button>
                            <button id="settings-save" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Save Changes</button>
                        </div>
                    </div>
                </div>

                <!-- Route Management Modal -->
                <div id="route-management-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-lg p-6 w-full max-w-7xl max-h-[90vh] overflow-hidden flex flex-col">
                        <div class="flex justify-between items-center mb-4">
                            <div class="flex items-center space-x-4">
                                <h3 class="text-xl font-bold">🛣️ Route Configuration</h3>
                                <div class="text-sm text-gray-600">
                                    Configure all 100 routes - only active routes appear on dashboard
                                </div>
                            </div>
                            <button id="route-modal-close" class="text-gray-500 hover:text-gray-700 text-xl">×</button>
                        </div>
                        
                        <!-- Action Bar -->
                        <div class="flex items-center justify-between mb-4 p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center space-x-4">
                                <button id="import-csv-btn" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm">
                                    📁 Import CSV
                                </button>
                                <button id="export-routes-csv-btn" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 text-sm">
                                    📤 Export CSV
                                </button>
                                <button id="reset-all-routes-btn" class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 text-sm">
                                    🔄 Reset All
                                </button>
                            </div>
                            <div class="flex items-center space-x-4 text-sm">
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-blue-500 rounded"></div>
                                    <span>Gen Ed</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-amber-500 rounded"></div>
                                    <span>Special Ed</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-emerald-500 rounded"></div>
                                    <span>Miscellaneous</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-gray-400 rounded"></div>
                                    <span>Inactive</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Route Configuration Grid -->
                        <div class="flex-1 overflow-y-auto">
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm">
                                    <thead class="bg-gray-100 sticky top-0">
                                        <tr>
                                            <th class="px-3 py-2 text-left font-medium text-gray-700 w-20">Route #</th>
                                            <th class="px-3 py-2 text-left font-medium text-gray-700 w-40">Type</th>
                                            <th class="px-3 py-2 text-left font-medium text-gray-700 w-32">Schedule</th>
                                            <th class="px-3 py-2 text-left font-medium text-gray-700">Assignments</th>
                                            <th class="px-3 py-2 text-left font-medium text-gray-700 w-24">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="route-config-grid">
                                        <!-- Routes 1-100 will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- Bulk Actions -->
                        <div class="mt-4 p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center space-x-4">
                                <div class="flex items-center space-x-2">
                                    <label class="text-sm font-medium text-gray-700">Bulk Actions:</label>
                                    <select id="bulk-route-range-start" class="px-2 py-1 border rounded text-sm w-20">
                                        <option value="1">1</option>
                                        <!-- Will be populated 1-100 -->
                                    </select>
                                    <span class="text-gray-500">to</span>
                                    <select id="bulk-route-range-end" class="px-2 py-1 border rounded text-sm w-20">
                                        <option value="100">100</option>
                                        <!-- Will be populated 1-100 -->
                                    </select>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <label class="text-sm text-gray-700">Set:</label>
                                    <select id="bulk-route-type" class="px-2 py-1 border rounded text-sm">
                                        <option value="">Select Type...</option>
                                        <option value="general-education">General Education</option>
                                        <option value="special-education">Special Education</option>
                                        <option value="miscellaneous">Miscellaneous</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                    <select id="bulk-route-schedule" class="px-2 py-1 border rounded text-sm">
                                        <option value="">Select Schedule...</option>
                                        <option value="am">AM Only</option>
                                        <option value="pm">PM Only</option>
                                        <option value="both">AM & PM</option>
                                        <option value="none">No Schedule</option>
                                    </select>
                                    <button id="apply-bulk-changes-btn" class="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm">
                                        Apply
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Hidden file input for CSV import -->
                        <input type="file" id="csv-import-input" class="hidden" accept=".csv" />
                    </div>
                </div>

                <!-- Asset Management Modal -->
                <div id="asset-management-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">🚛 Asset Management</h3>
                            <button id="asset-modal-close" class="text-gray-500 hover:text-gray-700 text-xl">×</button>
                        </div>
                        <div class="flex-1 overflow-y-auto">
                            <!-- CSV Import Section -->
                            <div class="mb-6 p-4 border border-dashed border-gray-300 rounded-lg bg-gray-50">
                                <h4 class="font-medium text-gray-700 mb-3">📁 Bulk Import Assets</h4>
                                <div id="asset-csv-drop-zone" class="border-2 border-dashed border-green-300 rounded-lg p-6 text-center bg-green-50 hover:bg-green-100 transition-colors cursor-pointer">
                                    <div class="text-green-600 mb-2">
                                        <svg class="mx-auto h-12 w-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                        </svg>
                                    </div>
                                    <p class="text-green-700 font-medium">Drag & drop CSV file here</p>
                                    <p class="text-green-600 text-sm mt-1">or click to browse</p>
                                    <input type="file" id="asset-csv-file-input" class="hidden" accept=".csv,.txt" />
                                </div>
                                <div class="mt-3 text-xs text-gray-600">
                                    <p><strong>CSV Format:</strong> Vehicle Number, Maximum Capacity, Type (optional), Status (optional)</p>
                                    <p><strong>Example:</strong> "052, 77, Bus, active" or "SUV 12-1, 7" or "Shop Truck, 6, Van, maintenance"</p>
                                </div>
                                <div id="asset-csv-status" class="mt-2 text-sm hidden"></div>
                            </div>
                            
                            <!-- Manual Bulk Entry Section -->
                            <div class="mb-6 p-4 border border-dashed border-gray-300 rounded-lg bg-gray-50">
                                <h4 class="font-medium text-gray-700 mb-3">📝 Manual Bulk Entry</h4>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Enter assets (one per line)</label>
                                        <textarea id="bulk-asset-input" class="w-full p-3 border rounded h-32 font-mono text-sm" 
                                                  placeholder="Enter assets one per line:&#10;052, 77, Bus, active&#10;SUV 12-1, 7, Van&#10;Shop Truck, 6&#10;1388, 77, Bus&#10;VAN 18-3, 8, Van, maintenance"></textarea>
                                    </div>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Default Type</label>
                                            <select id="bulk-default-asset-type" class="w-full p-2 border rounded text-sm">
                                                <option value="">Use per-line value</option>
                                                <option value="Bus">Bus (for all)</option>
                                                <option value="Van">Van (for all)</option>
                                                <option value="Car">Car (for all)</option>
                                                <option value="Suburban">Suburban (for all)</option>
                                                <option value="Other">Other (for all)</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Default Status</label>
                                            <select id="bulk-default-asset-status" class="w-full p-2 border rounded text-sm">
                                                <option value="">Use per-line value</option>
                                                <option value="active">Active (for all)</option>
                                                <option value="maintenance">Maintenance (for all)</option>
                                                <option value="retired">Retired (for all)</option>
                                            </select>
                                        </div>
                                        <div class="flex items-end">
                                            <button id="bulk-add-assets" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 w-full text-sm">
                                                Add All Assets
                                            </button>
                                        </div>
                                    </div>
                                    <div class="mt-3 text-xs text-gray-600">
                                        <p><strong>Format:</strong> Each line can be: "Vehicle Number, Capacity" or "Vehicle Number, Capacity, Type" or "Vehicle Number, Capacity, Type, Status"</p>
                                        <p><strong>Examples:</strong></p>
                                        <ul class="list-disc list-inside ml-2 mt-1">
                                            <li>052, 77 <span class="text-gray-500">(will use defaults for type/status)</span></li>
                                            <li>SUV 12-1, 7, Van <span class="text-gray-500">(will use default status)</span></li>
                                            <li>Shop Truck, 6, Van, maintenance <span class="text-gray-500">(complete specification)</span></li>
                                        </ul>
                                    </div>
                                    <div id="asset-bulk-status" class="mt-2 text-sm hidden"></div>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="asset-form-section">
                                    <h4 class="font-medium text-gray-700 mb-3">Add New Asset</h4>
                                    <form id="add-asset-form" class="space-y-3">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Asset Name/ID</label>
                                            <input type="text" id="asset-name" class="w-full p-2 border rounded" placeholder="Asset name or ID" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Maximum Capacity</label>
                                            <input type="number" id="asset-capacity" class="w-full p-2 border rounded" placeholder="Passenger capacity" min="0" max="200">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Type</label>
                                            <select id="asset-type" class="w-full p-2 border rounded" required>
                                                <option value="Bus">Bus</option>
                                                <option value="Van">Van</option>
                                                <option value="Car">Car</option>
                                                <option value="Suburban">Suburban</option>
                                                <option value="Other">Other</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                                            <select id="asset-status" class="w-full p-2 border rounded">
                                                <option value="active">Active</option>
                                                <option value="maintenance">Maintenance</option>
                                                <option value="retired">Retired</option>
                                            </select>
                                        </div>
                                        <button type="submit" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 w-full">Add Asset</button>
                                    </form>
                                </div>
                                <div class="asset-list-section">
                                    <h4 class="font-medium text-gray-700 mb-3">Current Assets</h4>
                                    <div id="asset-list-modal" class="space-y-2 max-h-64 overflow-y-auto">
                                        <!-- Assets will be populated here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Staff Management Modal -->
                <div id="staff-management-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">👥 Staff Management</h3>
                            <button id="staff-modal-close" class="text-gray-500 hover:text-gray-700 text-xl">×</button>
                        </div>
                        <div class="flex-1 overflow-y-auto">
                            <!-- CSV Import Section -->
                            <div class="mb-6 p-4 border border-dashed border-gray-300 rounded-lg bg-gray-50">
                                <h4 class="font-medium text-gray-700 mb-3">📁 Bulk Import Staff</h4>
                                <div id="staff-csv-drop-zone" class="border-2 border-dashed border-purple-300 rounded-lg p-6 text-center bg-purple-50 hover:bg-purple-100 transition-colors cursor-pointer">
                                    <div class="text-purple-600 mb-2">
                                        <svg class="mx-auto h-12 w-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                        </svg>
                                    </div>
                                    <p class="text-purple-700 font-medium">Drag and drop CSV file here</p>
                                    <p class="text-purple-600 text-sm mt-1">or click to browse</p>
                                    <input type="file" id="staff-csv-file-input" class="hidden" accept=".csv,.txt" />
                                </div>
                                <div id="staff-csv-status" class="mt-3 text-sm"></div>
                                
                                <!-- Bulk Import Options -->
                                <div class="mt-4 space-y-3">
                                    <h5 class="font-medium text-gray-600">Bulk Import Defaults</h5>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="text-sm text-gray-600">Default Status</label>
                                            <select id="bulk-default-staff-status" class="w-full p-2 border rounded text-sm">
                                                <option value="Active">Active</option>
                                                <option value="Inactive">Inactive</option>
                                                <option value="On Leave">On Leave</option>
                                                <option value="Training">Training</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="text-sm text-gray-600">Default Department</label>
                                            <select id="bulk-default-department" class="w-full p-2 border rounded text-sm">
                                                <option value="Transportation">Transportation</option>
                                                <option value="Dispatch">Dispatch</option>
                                                <option value="Maintenance">Maintenance</option>
                                                <option value="Administration">Administration</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Manual Add Staff Section -->
                            <div class="mb-6 p-4 border border-blue-200 rounded-lg bg-blue-50">
                                <h4 class="font-medium text-blue-700 mb-3">➕ Add New Staff Member</h4>
                                <form id="add-staff-form" class="space-y-4">
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">First Name *</label>
                                            <input type="text" id="staff-first-name" class="w-full p-2 border rounded" required>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Last Name *</label>
                                            <input type="text" id="staff-last-name" class="w-full p-2 border rounded" required>
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Employee ID</label>
                                            <input type="text" id="staff-employee-id" class="w-full p-2 border rounded">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Position</label>
                                            <input type="text" id="staff-position" class="w-full p-2 border rounded">
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Department</label>
                                            <select id="staff-department" class="w-full p-2 border rounded">
                                                <option value="Transportation">Transportation</option>
                                                <option value="Dispatch">Dispatch</option>
                                                <option value="Maintenance">Maintenance</option>
                                                <option value="Administration">Administration</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                                            <select id="staff-status" class="w-full p-2 border rounded">
                                                <option value="Active">Active</option>
                                                <option value="Inactive">Inactive</option>
                                                <option value="On Leave">On Leave</option>
                                                <option value="Training">Training</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                                            <input type="tel" id="staff-phone" class="w-full p-2 border rounded">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                            <input type="email" id="staff-email" class="w-full p-2 border rounded">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Notes</label>
                                        <textarea id="staff-notes" class="w-full p-2 border rounded" rows="2"></textarea>
                                    </div>
                                    <div class="flex justify-end">
                                        <button type="submit" class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700">
                                            Add Staff Member
                                        </button>
                                    </div>
                                </form>
                            </div>

                            <!-- Current Staff List -->
                            <div class="p-4 border border-gray-200 rounded-lg">
                                <div class="flex justify-between items-center mb-3">
                                    <h4 class="font-medium text-gray-700">Current Staff Members</h4>
                                    <button id="export-staff-list" class="px-3 py-1 text-sm bg-purple-100 text-purple-700 rounded hover:bg-purple-200">
                                        Export CSV
                                    </button>
                                </div>
                                <div id="staff-list-modal" class="space-y-2 max-h-64 overflow-y-auto">
                                    <!-- Staff will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Floating Search Overlay -->
                <div id="search-overlay" class="hidden fixed inset-0 bg-black bg-opacity-20 backdrop-blur-sm flex items-start justify-center z-50 pt-16">
                    <div class="bg-white rounded-lg shadow-2xl max-w-2xl w-full mx-4 transform transition-all duration-300 ease-out max-h-[calc(100vh-8rem)] overflow-y-auto">
                        <!-- Search Header -->
                        <div class="flex items-center justify-between p-4 border-b border-gray-200">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                    <svg class="h-4 w-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                    </svg>
                                </div>
                                <h3 class="text-lg font-semibold text-gray-800">Search Dashboard</h3>
                            </div>
                            <button id="search-overlay-close" class="text-gray-400 hover:text-gray-600 transition-colors" title="Close search">
                                <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        <!-- Main Search Input -->
                        <div class="p-4 border-b border-gray-100">
                            <div class="relative">
                                <input type="text" id="overlay-search-input" 
                                             placeholder="Search staff, routes, assets, notes..." 
                                             class="w-full pl-4 pr-12 py-3 text-lg border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                                             autocomplete="off">
                                <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                    <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                    </svg>
                                </div>
                            </div>
                            <!-- Search Results Counter -->
                            <div id="overlay-search-count" class="mt-2 text-sm text-gray-500 hidden">
                                <span id="overlay-count-text"></span>
                            </div>
                        </div>
                        <!-- Quick Filters -->
                        <div class="p-4 border-b border-gray-100">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="text-sm font-medium text-gray-700">Quick Filters</h4>
                                <button id="overlay-clear-filters" class="text-xs text-blue-600 hover:text-blue-700 transition-colors">Clear All</button>
                            </div>
                            <div class="flex flex-wrap gap-2">
                                <!-- Staff Filters -->
                                <div class="flex space-x-1">
                                    <span class="text-xs text-gray-500 px-2 py-1">Staff:</span>
                                    <button class="filter-quick-btn" data-type="staff" data-value="available">Available</button>
                                    <button class="filter-quick-btn" data-type="staff" data-value="out">Out</button>
                                    <button class="filter-quick-btn" data-type="staff" data-value="assigned">Assigned</button>
                                </div>
                                <!-- Route Filters -->
                                <div class="flex space-x-1">
                                    <span class="text-xs text-gray-500 px-2 py-1">Routes:</span>
                                    <button class="filter-quick-btn" data-type="route" data-value="gened">Gen Ed</button>
                                    <button class="filter-quick-btn" data-type="route" data-value="se">Special Ed</button>
                                    <button class="filter-quick-btn" data-type="route" data-value="field">Field Trip</button>
                                </div>
                                <!-- Asset Filters -->
                                <div class="flex space-x-1">
                                    <span class="text-xs text-gray-500 px-2 py-1">Assets:</span>
                                    <button class="filter-quick-btn" data-type="asset" data-value="available">Available</button>
                                    <button class="filter-quick-btn" data-type="asset" data-value="maintenance">Maintenance</button>
                                    <button class="filter-quick-btn" data-type="asset" data-value="out">Out</button>
                                </div>
                            </div>
                        </div>
                        <!-- Search Options -->
                        <div class="p-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4">
                                    <label class="flex items-center text-sm">
                                        <input type="checkbox" id="overlay-fuzzy-search" class="rounded text-blue-600 mr-2" checked>
                                        Smart matching
                                    </label>
                                    <label class="flex items-center text-sm">
                                        <input type="checkbox" id="overlay-case-sensitive" class="rounded text-blue-600 mr-2">
                                        Case sensitive
                                    </label>
                                </div>
                                <div class="flex space-x-2">
                                    <button id="overlay-advanced-btn" class="px-3 py-1 text-sm text-blue-600 hover:text-blue-700 transition-colors">
                                        <span id="advanced-btn-text">Advanced Options</span>
                                        <svg id="advanced-btn-icon" class="inline-block w-4 h-4 ml-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                        </svg>
                                    </button>
                                    <button id="overlay-save-search" class="px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors">
                                        Save Search
                                    </button>
                                </div>
                            </div>
                        </div>
                        <!-- Advanced Search Options (Hidden by default) -->
                        <div id="advanced-search-section" class="hidden border-t border-gray-100">
                            <div class="p-4 space-y-4">
                                <h4 class="text-sm font-semibold text-gray-700 mb-3">Detailed Search Fields</h4>
                                <!-- ...advanced search fields... -->
                            </div>
                        </div>
                        <!-- Keyboard Shortcuts Help -->
                        <div class="px-4 pb-4">
                            <div class="bg-gray-50 rounded p-3 text-xs text-gray-600">
                                <div class="flex items-center justify-between">
                                    <span><kbd class="bg-white px-1 rounded">Enter</kbd> to search • <kbd class="bg-white px-1 rounded">Esc</kbd> to close</span>
                                    <span><kbd class="bg-white px-1 rounded">Ctrl+Shift+F</kbd> for advanced search</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Timestamp Report Modal -->
                <div id="timestamp-report-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-lg max-w-4xl w-full max-h-screen overflow-hidden flex flex-col">
                        <div class="flex justify-between items-center p-4 border-b">
                            <h3 class="text-xl font-bold">Route Status Timestamp Report</h3>
                            <button id="timestamp-report-close" class="text-gray-500 hover:text-gray-700 text-xl">×</button>
                        </div>
                        <div class="p-4 flex-1 overflow-y-auto">
                            <div class="mb-4 flex justify-between items-center">
                                <div class="flex space-x-2">
                                    <button id="print-current-day" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Print Today's Report</button>
                                    <button id="clear-timestamps" class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600">Clear All Timestamps</button>
                                </div>
                                <div class="text-sm text-gray-600">
                                    Report generated: <span id="report-timestamp"></span>
                                </div>
                            </div>
                            <div id="timestamp-report-content" class="border rounded p-4 bg-gray-50">
                                <div class="text-center text-gray-500 py-8">
                                    Loading timestamp data...
                                </div>
                            </div>
                        </div>
                        <div class="p-4 border-t">
                            <button id="timestamp-report-cancel" class="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400">Close</button>
                        </div>
                    </div>
                </div>

        <!-- Modular JS Loader -->
        <script type="module" src="./src/app.js"></script>
        
        <!-- Additional CSS that was misplaced -->
        <style>
        .search-container {
            background: white;
            border-radius: 8px;
            padding: 24px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .search-input-wrapper {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .search-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 16px;
            outline: none;
        }
        
        .search-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .search-close {
            margin-left: 12px;
            padding: 8px 12px;
            background: #f3f4f6;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 18px;
            color: #6b7280;
        }
        
        .search-close:hover {
            background: #e5e7eb;
        }
        
        .search-results {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .search-result-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.15s ease;
        }
        
        .search-result-item:hover {
            background-color: #f9fafb;
        }
        
        .search-result-icon {
            margin-right: 12px;
            font-size: 18px;
        }
        
        .search-result-content {
            flex: 1;
        }
        
        .search-result-name {
            font-weight: 500;
            margin-bottom: 2px;
        }
        
        .search-result-meta {
            font-size: 14px;
            color: #6b7280;
        }
        
        .search-no-results {
            text-align: center;
            padding: 40px 20px;
            color: #6b7280;
        }
        
        /* Search Button */
        .search-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.15s ease;
        }
        
        .search-button:hover {
            background: #2563eb;
        }
        
        .context-menu {
            animation: contextMenuFadeIn 0.2s ease-out;
        }
        
        @keyframes contextMenuFadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .virtual-list-viewport {
            overflow: auto;
        }
        
        .virtual-list-content {
            will-change: transform;
        }
        
        .gesture-tutorial {
            animation: tutorialFadeIn 0.3s ease-out;
        }
        
        @keyframes tutorialFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Touch optimizations */
        .touch-primary .route-card,
        .touch-primary .staff-item,
        .touch-primary .asset-item {
            min-height: 48px;
            padding: 12px;
        }
        
        .touch-primary button {
            min-height: 48px;
            padding: 12px 16px;
        }
        
        /* Screen reader announcer */
        #screen-reader-announcer {
            position: absolute;
            left: -10000px;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }
    </style>

    <!-- JavaScript -->
    <script type="module" src="./src/app.js"></script>
    <script type="module" src="./src/modules/ui/search-debug.js"></script>
    </body>
</html>
